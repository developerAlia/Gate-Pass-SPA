<div class="row mb-2" *ngIf="this.isSecurity">
  <div class="col-auto">
    <img
      class="img-100 rounded-circle"
      alt=""
      src="{{
        this.visitorDetails.get('imgURL').value
          ? 'data:image/jpg;base64,' + this.visitorDetails.get('imgURL').value
          : 'assets/images/user/user.png'
      }}"
    />
  </div>
</div>

<div class="row" [formGroup]="visitorDetails" *ngIf="visitorDetails">
  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
    <label for="name"
      >{{ "Name" | translate }} <span class="font-danger">*</span>:</label
    >
    <app-text-input
      [formControl]="visitorDetails.controls['name']"
      [label]="'Name' | translate"
    >
    </app-text-input>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
    <label for="name"
      >{{ "Gender" | translate }} <span class="font-danger">*</span>:</label
    >
    <app-gender-selection formControlName="zGenderId"> </app-gender-selection>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mt-2">
    <label for="MobileNumber"
      >{{ "MobileNumber" | translate }}
      <span class="font-danger">*</span>:</label
    >
    <app-text-input
      [formControl]="visitorDetails.controls['phone']"
      [label]="'MobileNumber' | translate"
      (keypress)="($event.charCode >= 48 && $event.charCode < 58)"
      [type]="'text'"
      [maxLength]="8"
    >
    </app-text-input>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mt-2">
    <label for="name"
      >{{ "Nationality" | translate }}
      <span class="font-danger">*</span>:</label
    >

    <nationality-autocomplete formControlName="zNationalityID">
    </nationality-autocomplete>
  </div>

  <!-- {{this.numOfDays}} -->
  <div
    class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt-2"
    *ngIf="this.visitorDetails.get('numberOfDays').value > 14"
  >
    <label for="name"
      >{{ "RelationShip" | translate }}
      <span class="font-danger">*</span>:</label
    >
    <app-relationship-selection
      formControlName="zRelationshipId"
      [numOfDays]="this.visitorDetails.get('numberOfDays').value"
    ></app-relationship-selection>
  </div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div class="row">
      <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mt-2">
        <label for="name"
          >{{ "IdExpiryDate" | translate }}
          <span class="font-danger">*</span>:</label
        >
        <app-date-picker
          [formControl]="visitorDetails.controls['civilIdExpairyDate']"
          [label]="'IdExpiryDate' | translate"
          [readonlyStatus]="
            !this.visitorDetails.controls['civilIdExpairyDate'].disabled
          "
          [minDate]="this.minDate"
        >
        </app-date-picker>
      </div>

      <div
        class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mt-2"
        *ngIf="
          (this.visitorDetails.get('isExpire').value == true &&
            this.visitorDetails.get('isCivilAttachRequired').value == true &&
            this.visitorDetails.get('civilIdURL').value != null) ||
          (this.visitorDetails.get('civilIdURL').value == null &&
            this.visitorDetails.get('isExpire').value == true &&
            this.visitorDetails.get('isCivilAttachRequired').value == true) ||
          (this.visitorDetails.get('civilIdURL').value == null &&
            this.visitorDetails.get('isExpire').value == false &&
            this.visitorDetails.get('isCivilAttachRequired').value == true &&
            this.isSecurity == false)
        "
      >
        <label for="name"
          >{{ "AttachmentIdCard" | translate }}
          <span class="font-danger">*</span>:</label
        >
        <app-upload-file
          [formControl]="visitorDetails.controls['attachIdCard']"
          [label]="'idCard'"
          [fileType]="'PDF'"
          (change)="
            checkFileSize(
              $event.target.files,
              'visitorDetails.attachIdCard',
              true
            )
          "
        ></app-upload-file>
      </div>

      <div
        class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mt-2"
        *ngIf="isSecurity"
      >
        <label for="name">{{ "AttachmentIdCard" | translate }}:</label>
        <div>
          <a
            href="javascript:void(0)"
            id="viewAttachment"
            name="viewAttachment"
            ngbTooltip="View Document"
            class="mt-1"
            ><i
              class="fa fa-file-pdf-o"
              style="font-size: 1.73em"
              (click)="getAttachmentFile()"
            ></i
          ></a>
        </div>
      </div>

      <!-- (this.visitorDetails.get('isPhotoAttachRequired').value == true &&
              this.visitorDetails.get('photoAttach').value == null &&
              !this.visitorDetails.get('imgURL').value == null && this.isSecurity == false) ||
            (this.visitorDetails.get('isPhotoAttachRequired').value == true &&
              this.visitorDetails.get('photoAttach').value != null &&
              this.visitorDetails.get('imgURL').value != null &&
              this.isSecurity == false) -->
      <div
        class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mt-2"
        *ngIf="
          this.visitorDetails.get('isPhotoAttachRequired').value == true &&
          this.visitorDetails.get('imgURL').value == null &&
          this.isSecurity == false
        "
      >
        <label for="name">{{ "AttachmentPersonalPhoto" | translate }}:</label>

        <app-upload-image
          [formControl]="visitorDetails.controls['photoAttach']"
          (change)="
            checkFileSize(
              $event.target.files,
              'visitorDetails.photoAttach',
              false
            )
          "
          [tempURLImg]="this.tempURLImg"
        ></app-upload-image>
      </div>

      <!-- <div
        class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt-4"
        *ngIf="this.isSecurity"
      >
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="form-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  id="gridCheck"
                  type="checkbox"
                  [disabled]="false"
                  [formControl]="
                    visitorDetails.controls['securitySide'].controls[
                      'isverified'
                    ]
                  "
                />
                <label class="form-check-label" for="gridCheck">{{
                  "VERIFIED" | translate
                }}</label>
              </div>
            </div>
          </div>

          <div
            class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt-4"
            *ngIf="visitorDetails.get('securitySide.isverified').value == false"
          >
            <label for="Note">{{ "Note" | translate }}:</label>
            <app-text-area
              [formControl]="
                visitorDetails.controls['securitySide'].controls['notes']
              "
            ></app-text-area>
          </div>
        </div>
      </div> -->

      <!-- Offical Use Only -->

      <fieldset
        class="form-group border col-xs-12 col-sm-12 col-md-12 col-lg-12 mt-4"
        *ngIf="
          this.isSecurity ||
          (visitorDetails.value.isEdit == true &&
            visitorDetails.value.requestsId != 0)
        "
      >
        <legend class="w-auto px-2">
          <h5>{{ "OfficalUseOnly" | translate }}</h5>
        </legend>
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mb-4">
            <div class="row">
              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <check-box
                  [formControl]="
                    visitorDetails.controls['securitySide'].controls[
                      'isverified'
                    ]
                  "
                  [id]="'visitorDetailsCheckBox'"
                ></check-box>
              </div>

              <div
                class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt-2"
                *ngIf="!visitorDetails.get('securitySide.isverified').value"
              >
                <label for="Note"
                  >{{ "Note" | translate }}
                  <span class="font-danger">*</span>:</label
                >
                <app-text-area
                  [formControl]="
                    visitorDetails.controls['securitySide'].controls['notes']
                  "
                ></app-text-area>
              </div>
            </div>
          </div>
        </div>
      </fieldset>
    </div>
  </div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div class="row mt-4">
      <div
        class="col-xs-6 col-sm-6 col-md-6 col-lg-6 d-flex justify-content-start"
      >
        <button class="btn btn-light mr-1" type="button" awPreviousStep>
          Back
        </button>
      </div>
      <div
        class="col-xs-6 col-sm-6 col-md-6 col-lg-6 d-flex justify-content-end"
      >
        <button
          class="btn btn-primary mr-1"
          type="button"
          [disabled]="!visitorDetails.valid"
          awNextStep
          (click)="postExternalUser()"
          *ngIf="!this.isSecurity && visitorDetails.value.isEdit == true"
        >
          {{ "NEXT" | translate }}
        </button>
        <button
          class="btn btn-primary mr-1"
          type="button"
          (click)="verifyUserData()"
          [disabled]="!this.visitorDetails.get('securitySide').valid"
          *ngIf="this.isSecurity"
        >
          {{ "NEXT" | translate }}
        </button>
        <button
          class="btn btn-primary mr-1"
          type="button"
          *ngIf="!visitorDetails.value.isEdit && isSecurity == false"
          awNextStep
        >
          {{ "NEXT" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>
